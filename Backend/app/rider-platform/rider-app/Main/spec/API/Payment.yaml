imports:
  CustomerCardListResp: Kernel.External.Payment.Interface.Types
  CustomerId: Kernel.External.Payment.Interface.Types
  PaymentMethodId: Kernel.External.Payment.Interface.Types
  APISuccess: Kernel.Types.APISuccess
  Ride: Domain.Types.Ride
  PriceAPIEntity: Kernel.Types.Common
  CreateCustomerResp : Kernel.External.Payment.Interface.Types
  RefundRequestStatus: Domain.Types.RefundRequest
  RefundRequestCode: Domain.Types.RefundRequest
  RefundPurpose: Domain.Types.RefundRequest
  FileType: AWS.S3

module: RidePayment
types:
  SetupIntentResponse:
    setupIntentClientSecret: Text
    customerId: CustomerId
    ephemeralKey: Text
  PaymentIntentResponse:
    paymentIntentClientSecret: Text
    customerId: CustomerId
    ephemeralKey: Text
  PaymentMethodsResponse:
    list: CustomerCardListResp
    defaultPaymentMethodId: Maybe PaymentMethodId
  AddTipRequest:
    recordType: NewType
    amount: PriceAPIEntity
  RefundRequestReq:
    requestedAmount: Maybe PriceAPIEntity
    code: RefundRequestCode
    description: Text
    evidence: Maybe Text
    fileType: Maybe FileType
    reqContentType: Maybe Text
  RefundRequestResp:
    rideId: Id Ride
    requestedAmount: Maybe PriceAPIEntity
    transactionAmount: PriceAPIEntity
    refundPurpose: RefundPurpose
    status: RefundRequestStatus
    code: RefundRequestCode
    description: Text
    responseDescription: Maybe Text
    refundsAmount: Maybe PriceAPIEntity
    evidence: Maybe Text
    createdAt: UTCTime
    updatedAt: UTCTime

apis:
  - GET:
      endpoint: /payment/methods
      auth: TokenAuth
      response:
        type: PaymentMethodsResponse
  - POST:
      endpoint: /payment/methods/{paymentMethodId}/makeDefault
      params:
        paymentMethodId: PaymentMethodId
      auth: TokenAuth
      response:
        type: APISuccess
  - GET:
      endpoint: /payment/intent/setup
      auth: TokenAuth
      response:
        type: SetupIntentResponse
  - GET:
      endpoint: /payment/intent/payment
      auth: TokenAuth
      response:
        type: PaymentIntentResponse
  - POST:
      endpoint: /payment/{rideId}/method/{paymentMethodId}/update
      auth: TokenAuth
      params:
        rideId: Id Ride
        paymentMethodId: PaymentMethodId
      response:
        type: APISuccess
  - DELETE:
      endpoint: /payment/methods/{paymentMethodId}/delete
      auth: TokenAuth
      params:
        paymentMethodId: PaymentMethodId
      response:
        type: APISuccess
  - POST:
      endpoint: /payment/{rideId}/addTip
      auth: TokenAuth
      params:
        rideId: Id Ride
      request:
        type: AddTipRequest
      response:
        type: APISuccess
  - GET:
      endpoint : /payment/customer
      auth: TokenAuth
      response:
        type: CreateCustomerResp
  - POST:
      endpoint: /payment/{rideId}/refundRequest/create
      auth: TokenAuth
      params:
        rideId: Id Ride
      request:
        type: RefundRequestReq
      response:
        type: APISuccess
  - GET:
      endpoint: /payment/{rideId}/refundRequest
      auth: TokenAuth
      params:
        rideId: Id Ride
      query:
        refreshRefunds: Bool
      response:
        type: RefundRequestResp
