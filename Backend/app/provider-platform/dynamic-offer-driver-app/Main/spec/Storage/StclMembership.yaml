imports:
  Person: Domain.Types.Person
  Merchant: Domain.Types.Merchant
  MerchantOperatingCity: Domain.Types.MerchantOperatingCity
  UTCTime: Kernel.Prelude
  EncryptedHashedField: Kernel.External.Encryption
  DbHash: Kernel.External.Encryption
  Day: Data.Time

StclMembership:
  tableName: stcl_membership
  fields:
    id: Id StclMembership
    driverId: Id Person
    applicationId: Text
    shortId: Maybe Text
    firstName: Text
    lastName: Text
    memberCategory: Text
    numberOfShares: Int
    dateOfBirth: Day
    panNumber: EncryptedHashedField e Text
    mobileNumber: EncryptedHashedField e Text
    emailId: Text
    fatherMotherName: Text
    addressStreetAddress1: Text
    addressStreetAddress2: Maybe Text
    addressCity: Text
    addressState: Text
    addressPostalCode: Text
    bankName: Text
    bankBranch: Text
    accountNumber: EncryptedHashedField e Text
    ifscCode: EncryptedHashedField e Text
    vehicleType: Text
    fuelTypes: "[Text]"
    nomineeName: Text
    declarationPlace: Text
    declarationDate: Day
    declarationSignature: Text
    termsAccepted: Bool
    status: ApplicationStatus
    paymentStatus: Maybe Text
    merchantId: Id Merchant
    merchantOperatingCityId: Id MerchantOperatingCity
    createdAt: UTCTime
    updatedAt: UTCTime
  types:
    ApplicationStatus:
      enum: "SUBMITTED,PENDING,APPROVED,REJECTED"
  default:
    status: "'SUBMITTED'"
  constraints:
    id: PrimaryKey
    driverId: SecondaryKey
    applicationId: SecondaryKey
    panNumberHash: "!SecondaryKey"
    mobileNumberHash: "!SecondaryKey"
    accountNumberHash: "!SecondaryKey"
  beamFields:
    panNumber:
      panNumberEncrypted: Text
      panNumberHash: DbHash
    mobileNumber:
      mobileNumberEncrypted: Text
      mobileNumberHash: DbHash
    accountNumber:
      accountNumberEncrypted: Text
      accountNumberHash: DbHash
    ifscCode:
      ifscCodeEncrypted: Text
      ifscCodeHash: DbHash
  fromTType:
    panNumber: EncryptedHashed (Encrypted panNumberEncrypted) panNumberHash|E
    mobileNumber: EncryptedHashed (Encrypted mobileNumberEncrypted) mobileNumberHash|E
    accountNumber: EncryptedHashed (Encrypted accountNumberEncrypted) accountNumberHash|E
    ifscCode: EncryptedHashed (Encrypted ifscCodeEncrypted) ifscCodeHash|E
  toTType:
    panNumberEncrypted: (unEncrypted . (.encrypted) $ panNumber)|E
    panNumberHash: ((.hash) panNumber)|E
    mobileNumberEncrypted: (unEncrypted . (.encrypted) $ mobileNumber)|E
    mobileNumberHash: ((.hash) mobileNumber)|E
    accountNumberEncrypted: (unEncrypted . (.encrypted) $ accountNumber)|E
    accountNumberHash: ((.hash) accountNumber)|E
    ifscCodeEncrypted: (unEncrypted . (.encrypted) $ ifscCode)|E
    ifscCodeHash: ((.hash) ifscCode)|E
  sqlType:
    panNumberEncrypted: character varying(255)
    panNumberHash: bytea
    mobileNumberEncrypted: character varying(255)
    mobileNumberHash: bytea
    accountNumberEncrypted: character varying(255)
    accountNumberHash: bytea
    ifscCodeEncrypted: character varying(255)
    ifscCodeHash: bytea
    fuelTypes: text[]
  queries:
    findById:
      kvFunction: findOneWithKV
      where: id
    findByDriverId:
      kvFunction: findAllWithKV
      where: driverId
    findByApplicationId:
      kvFunction: findOneWithKV
      where: applicationId
    findByShortId:
      kvFunction: findOneWithKV
      where: shortId
    findByDriverIdAndStatus:
      kvFunction: findAllWithKV
      where:
        and: [driverId, status]
    updateStatus:
      kvFunction: updateOneWithKV
      params: [status, updatedAt]
      where: id
    updateStatusAndPaymentStatus:
      kvFunction: updateOneWithKV
      params: [status, paymentStatus, updatedAt]
      where: id
  extraOperations:
    - EXTRA_QUERY_FILE

