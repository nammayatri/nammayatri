INSERT INTO atlas_app.merchant_onboarding_step_config (
    onboarding_type,
    step_name_identifier,
    step_description,
    dependency,
    is_approval_required,
    created_at,
    updated_at
) VALUES (
    'TICKET_MERCHANT_ONBOARDING',
    'TICKET-MERCHANT-DETAILS',
    'Please provide merchant information',
    ARRAY[]::text[],
    true,
    NOW(),
    NOW()
);
-- already ran in master -- do not run again in master..
INSERT INTO atlas_app.merchant_onboarding_step_config (
    onboarding_type,
    step_name_identifier,
    step_description,
    dependency,
    is_approval_required,
    is_admin_only,
    created_at,
    updated_at
) VALUES (
    'TICKET_MERCHANT_ONBOARDING',
    'BANK-ONBOARDING',
    'Bank onboarding',
    ARRAY['TICKET-MERCHANT-DETAILS']::text[],
    true,
    true,
    NOW(),
    NOW()
) ON CONFLICT DO NOTHING;

WITH MerchantMessages AS (
  SELECT T1.merchant_id, 'TICKET_MERCHANT_AGREEMENT_TEMPLATE',
'<!doctypehtml><html lang=en><meta charset=UTF-8><meta content="width=device-width,initial-scale=1"name=viewport><title>Letter from Merchant</title><style>body{font-family:Arial,sans-serif;line-height:1.6;margin:40px}.letter{border:1px solid #000;padding:20px;max-width:800px;margin:0 auto}.letter-header{margin-bottom:40px}.letter-footer{margin-top:40px}.signature{margin-top:60px}.letter-subject{font-weight:700}.container{width:600px;word-wrap:break-word}</style><div class=letter><div class=letter-header><p><strong>To,</strong><p>Date: {#date#}<p>Naveen Chaluvadi,<br>Chief Digital Officer, YES Bank<br>5th Floor, Digital Banking,<br>YES Bank House, Off Western Express Highway,<br>Santacruz (E), Mumbai - 400055</div><div class=letter-body><p class=letter-subject>Sub: Settlement of UPI Collections through Society for Natural Language Technology Research (SNLTR), Government of West Bengal, IT&E Department via YES Bank’s UPI payments setup<p>Dear Sir,<p>We hereby confirm that <strong>{#orgName#}</strong> is availing the services of UPI Collections offered by Society for Natural Language Technology Research (SNLTR), Government of West Bengal, IT&E Department through YES Bank UPI payments setup and also agrees to the terms laid down between Society for Natural Language Technology Research (SNLTR), Government of West Bengal, IT&E and YES Bank for the use case mentioned below:<p><strong>Use Case: &lt;Ticketing through Yatri Sathi Mobile Application.></strong><p>We request YES Bank to process the settlement for these collections to -<p><strong>Account Number:</strong> {#accountNumber#}<br><strong>IFSC:</strong> {#ifsc#}<p><strong>Other Details:</strong><p>GST Number: {#gstNumber#}<br>GST Address:<div class=container>{#gstAddress#}<div><br>PAN Number: {#pan#}</div><div class=letter-footer><p>Yours Sincerely,<div class=signature><p>Official Signatory<p>Designation<p>Address</div></div></div>'
  , T1.id
  FROM atlas_app.merchant_operating_city AS T1
)
INSERT INTO atlas_app.merchant_message (merchant_id, message_key, message, merchant_operating_city_id)
  (SELECT * FROM MerchantMessages);

-- already ran in master do not run again --
WITH MerchantMessages AS (
  SELECT T1.merchant_id, 'TICKET_MERCHANT_SNLTR_TEMPLATE',
'<!DOCTYPE html><html><head><meta charset="UTF-8"><title>Letter from SNLTR</title><style> body { font-family: Arial, sans-serif; margin: 40px; line-height: 1.6; } h1 { text-align: center; font-size: 24px; text-decoration: underline; } .address, .signature { margin-top: 30px; } table { border-collapse: collapse; margin-top: 20px; width: 100%; table-layout: fixed; } th, td { border: 1px solid #000; padding: 8px; word-wrap: break-word; overflow-wrap: break-word; word-break: break-word; } ul li { word-wrap: break-word; overflow-wrap: break-word; word-break: break-word; } </style></head><body><p><em>&lt;To be printed on the respective entity’s letterhead&gt;</em></p><div class="address"><p>To, <br> Naveen Chaluvadi, <br> Chief Digital Officer, YES Bank <br> 5th Floor, Digital Banking, <br> YES Bank House, Off Western Express Highway, <br> Santacruz (E), Mumbai - 400055</p><p><strong>Date:</strong></p></div><p><strong>Sub:</strong> Enabling UPI Collections on YES Bank</p><p>Dear Sir,</p><p> We hereby request you to enable UPI collections on YES Bank for the below mentioned entities powered by Society for Natural Language Technology Research (SNLTR), Government of West Bengal, IT&E Department against their corresponding use cases. The settlement for these entities would have to be processed to their respective bank accounts.</p><table><tr><th>Sl. No</th><th>Legal Name (Entity''s Legal Name)</th><th>Use Case (Description)</th></tr><tr><td>1</td><td><span style="display:inline-block; max-width:100%; word-wrap:break-word; word-break:break-word;">{#orgName#}</span></td><td>Ticketing through Yatri Sathi Mobile Application</td></tr></table><p> Under this engagement, Society for Natural Language Technology Research (SNLTR), Government of West Bengal, IT&E Department agrees to the following:</p><ol><li>Society for Natural Language Technology Research (SNLTR) has decided to appoint YES Bank Ltd. to enable UPI collections & as the settlement banker for this project.</li><li>YES BANK will open and operate office accounts for this project, for settlement and payments of the funds from registered remitter and beneficiaries, respectively.</li><li>YES BANK will settle the funds to Entities account on T+1 working day.</li><li>If the transfer cannot be executed owing to a bank holiday or any other reason, or if the transfer fails for any reason, it shall be executed on the next Banking Day.</li><li>Society for Natural Language Technology Research (SNLTR) shall notify the Bank from time to time in case of any changes/revisions in any of the settlement terms and shall provide a reasonable time frame as per mutual agreement to implement the same.</li></ol><p><strong>Details for Society for Natural Language Technology Research (SNLTR), Government of West Bengal, IT&E Department -</strong></p><ul><li><strong>GST Number: </strong> {#gstNumber#} </li><li><strong>GST Address: </strong><span style="display: inline-block; max-width: 100%; word-wrap: break-word; word-break: break-word;">{#gstAddress#}</span></li><li><strong>PAN Number: </strong> {#pan#} </li></ul><div class="signature"><p>Yours Sincerely,</p><p>Official Signatory<br> Designation<br> Monibhandar (5th and 6th Floor),<br> Premise of Webel Bhavan, Block - EP & GP,<br> Sector-V, Salt Lake, Kolkata - 700091</p></div></body></html>'
  , T1.id
  FROM atlas_app.merchant_operating_city AS T1
)
INSERT INTO atlas_app.merchant_message (merchant_id, message_key, message, merchant_operating_city_id)
  (SELECT * FROM MerchantMessages);

UPDATE atlas_app.merchant_message
SET message = '<!DOCTYPE html><html lang="en"><head> <meta charset="UTF-8" /> <meta name="viewport" content="width=device-width, initial-scale=1" /> <title>Letter from Merchant</title> <style> body { font-family: Arial, sans-serif; line-height: 1.4; margin: 40px; color: #000; background: #fff; } .letter { border: 1px solid #000; padding: 20px; max-width: 800px; margin: 0 auto; } .letter-header { margin-bottom: 40px; } .letter-footer { margin-top: 20px; } .letter-footer p { margin: 4px 0; } .signature { margin-top: 20px; } .letter-subject { font-weight: 700; } .gst-line { display: flex; align-items: flex-start; gap: 5px; } @page { margin: 1in !important; } @media print { body { -webkit-print-color-adjust: exact; print-color-adjust: exact; color: #000 !important; background: #fff !important; } .letter { border: 1px solid #000 !important; } .no-break { page-break-inside: avoid; } } </style></head><body> <div class="letter"> <div class="letter-header"> <p><strong>To,</strong></p> <p>Date: {#date#}</p> <p> Naveen Chaluvadi,<br> Chief Digital Officer, YES Bank<br> 5th Floor, Digital Banking,<br> YES Bank House, Off Western Express Highway,<br> Santacruz (E), Mumbai - 400055 </p> </div> <div class="letter-body no-break"> <p class="letter-subject"> Sub: Settlement of UPI Collections through Society for Natural Language Technology Research (SNLTR), Government of West Bengal, IT&E Department via YES Bank''s UPI payments setup </p> <p>Dear Sir,</p> <p> We hereby confirm that <strong>{#orgName#}</strong> is availing the services of UPI Collections offered by Society for Natural Language Technology Research (SNLTR), Government of West Bengal, IT&E Department through YES Bank UPI payments setup and also agrees to the terms laid down between Society for Natural Language Technology Research (SNLTR), Government of West Bengal, IT&E and YES Bank for the use case mentioned below: </p> <p><strong>Use Case: &lt;Ticketing through Yatri Sathi Mobile Application.&gt;</strong></p> <p>We request YES Bank to process the settlement for these collections to -</p> <p> <strong>Account Number:</strong> {#accountNumber#}<br> <strong>IFSC:</strong> {#ifsc#} </p> <p><strong>Other Details:</strong></p> <p><strong>GST Number:</strong> {#gstNumber#}</p> <p class="gst-line"><strong>GST Address:</strong> <span>{#gstAddress#}</span></p> <p><strong>PAN Number:</strong> {#pan#}</p> </div> <div class="letter-footer no-break"> <p style="margin: 0;">Yours Sincerely,</p> <div class="signature"> <p>Official Signatory</p> <p>Designation</p> <p>Address</p> </div> </div> </div> <!-- Prevent clipping at the bottom --> <div style="height: 60px;"></div></body></html>'
WHERE message_key = 'TICKET_MERCHANT_AGREEMENT_TEMPLATE';


UPDATE atlas_app.merchant_message
SET message = '<!DOCTYPE html><html><head> <meta charset="UTF-8"> <title>Letter from SNLTR</title> <style> body { font-family: Arial, sans-serif; line-height: 1.4; color: #000; background: #fff; margin: 0; padding: 0; } .letter { max-width: 800px; margin: 0 auto; padding: 40px; } h1 { text-align: center; font-size: 24px; text-decoration: underline; } .address, .signature { margin-top: 30px; page-break-inside: avoid;} table { border-collapse: collapse; margin-top: 20px; width: 100%; table-layout: fixed; } th, td { border: 1px solid #000; padding: 8px; word-wrap: break-word; overflow-wrap: break-word; word-break: break-word; } ul li, ol li { word-wrap: break-word; overflow-wrap: break-word; word-break: break-word; } @page { margin: 1in !important; } @media print { body { -webkit-print-color-adjust: exact; print-color-adjust: exact; color: #000 !important; background: #fff !important; } table, th, td { border: 1px solid #000 !important; } } </style></head><body> <div class="letter"> <p><em>&lt;To be printed on the respective entity''s letterhead&gt;</em></p> <div class="address"> <p>To,<br> Naveen Chaluvadi,<br> Chief Digital Officer, YES Bank<br> 5th Floor, Digital Banking,<br> YES Bank House, Off Western Express Highway,<br> Santacruz (E), Mumbai - 400055 </p> <p><strong>Date:</strong> {#date#}</p> </div> <p><strong>Sub:</strong> Enabling UPI Collections on YES Bank</p> <p>Dear Sir,</p> <p> We hereby request you to enable UPI collections on YES Bank for the below mentioned entities powered by Society for Natural Language Technology Research (SNLTR), Government of West Bengal, IT&E Department against their corresponding use cases. The settlement for these entities would have to be processed to their respective bank accounts. </p> <table> <tr> <th>Sl. No</th> <th>Legal Name (Entity''s Legal Name)</th> <th>Use Case (Description)</th> </tr> <tr> <td>1</td> <td style="max-width:100%; word-wrap:break-word; word-break:break-word;">{#orgName#}</td> <td>Ticketing through Yatri Sathi Mobile Application</td> </tr> </table> <p>Under this engagement, Society for Natural Language Technology Research (SNLTR), Government of West Bengal, IT&E Department agrees to the following:</p> <ol> <li>Society for Natural Language Technology Research (SNLTR) has decided to appoint YES Bank Ltd. to enable UPI collections & as the settlement banker for this project.</li> <li>YES BANK will open and operate office accounts for this project, for settlement and payments of the funds from registered remitter and beneficiaries, respectively.</li> <li>YES BANK will settle the funds to Entities account on T+1 working day.</li> <li>If the transfer cannot be executed owing to a bank holiday or any other reason, or if the transfer fails for any reason, it shall be executed on the next Banking Day.</li> <li>Society for Natural Language Technology Research (SNLTR) shall notify the Bank from time to time in case of any changes/revisions in any of the settlement terms and shall provide a reasonable time frame as per mutual agreement to implement the same.</li> </ol> <p><strong>Details for Society for Natural Language Technology Research (SNLTR), Government of West Bengal, IT&E Department -</strong></p> <ul> <li><strong>GST Number: </strong> {#gstNumber#}</li> <li><strong>GST Address: </strong> <span style="display: inline-block; max-width: 100%; word-wrap: break-word; word-break: break-word;">{#gstAddress#}</span> </li> <li><strong>PAN Number: </strong> {#pan#}</li> </ul> <div class="signature"> <p>Yours Sincerely,</p> <p>Official Signatory<br> Designation<br> Monibhandar (5th and 6th Floor),<br> Premise of Webel Bhavan, Block - EP & GP,<br> Sector-V, Salt Lake, Kolkata - 700091 </p> </div> <!-- Spacer to prevent clipping when saving as PDF --> <div style="height: 60px;"></div> </div></body></html>'
WHERE message_key = 'TICKET_MERCHANT_SNLTR_TEMPLATE';